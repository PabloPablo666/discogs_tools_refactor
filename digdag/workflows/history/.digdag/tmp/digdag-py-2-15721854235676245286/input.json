{"params":{"run_ids":"20260118_202946","_project_path":"/Users/paoloolivieri/discogs_tools_refactor/digdag/workflows/history","project_root":"/Users/paoloolivieri/discogs_tools_refactor","raw_root":"/Users/paoloolivieri/discogs_store/raw","trino_container":"trino","trino_catalog":"hive","run_mode":"history","timezone":"UTC","session_uuid":"47b9102c-6370-4622-9959-4972000c0234","session_time":"2026-01-20T12:07:00+00:00","session_id":1,"session_date":"2026-01-20","session_date_compact":"20260120","session_local_time":"2026-01-20 12:07:00","session_tz_offset":"+0000","session_unixtime":1768910820,"last_executed_session_time":"","last_executed_session_date":"","last_executed_session_date_compact":"","last_executed_session_local_time":"","last_executed_session_tz_offset":"+0000","last_executed_session_unixtime":"","project_id":1,"attempt_id":1,"task_name":"+history_reports+init","py>":"import json, re\nraw = \"\"\"20260118_202946\"\"\".strip()\n\nrun_ids = None\nif raw.startswith('[') and raw.endswith(']'):\n  try:\n    run_ids = json.loads(raw)\n  except Exception:\n    inner = raw[1:-1].strip()\n    parts = [p.strip().strip('\"').strip(\"'\") for p in inner.split(',') if p.strip()]\n    run_ids = parts\nelse:\n  parts = re.split(r'[\\s,]+', raw)\n  run_ids = [p.strip().strip('\"').strip(\"'\") for p in parts if p.strip()]\n\nif not isinstance(run_ids, list) or not run_ids:\n  raise ValueError(f\"run_ids empty/unparsable: {raw}\")\n\nbad = [x for x in run_ids if not re.match(r'^\\d{8}_\\d{6}(__(\\d{8}|\\d{4}_\\d{2}))?$', str(x))]\nif bad:\n  raise ValueError(f\"invalid run_id(s): {bad}\")\n\n{\"run_ids_list\": [str(x) for x in run_ids]}\n","_type":"py","_command":"import json, re\nraw = \"\"\"20260118_202946\"\"\".strip()\n\nrun_ids = None\nif raw.startswith('[') and raw.endswith(']'):\n  try:\n    run_ids = json.loads(raw)\n  except Exception:\n    inner = raw[1:-1].strip()\n    parts = [p.strip().strip('\"').strip(\"'\") for p in inner.split(',') if p.strip()]\n    run_ids = parts\nelse:\n  parts = re.split(r'[\\s,]+', raw)\n  run_ids = [p.strip().strip('\"').strip(\"'\") for p in parts if p.strip()]\n\nif not isinstance(run_ids, list) or not run_ids:\n  raise ValueError(f\"run_ids empty/unparsable: {raw}\")\n\nbad = [x for x in run_ids if not re.match(r'^\\d{8}_\\d{6}(__(\\d{8}|\\d{4}_\\d{2}))?$', str(x))]\nif bad:\n  raise ValueError(f\"invalid run_id(s): {bad}\")\n\n{\"run_ids_list\": [str(x) for x in run_ids]}\n"}}